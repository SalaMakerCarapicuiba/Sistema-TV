{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horário de Aulas</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/global.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript">
        function fetchWeatherData() {
            $.ajax({
                url: "{% url 'home' %}",  // URL da sua view Django que retorna os dados da API
                method: "GET",
                success: function(data) {
                    if (data.error) {
                        console.error(data.error);
                    } else {
                        // Atualiza os campos de temperatura
                        $('#today-temp').html(`${data.temp_min}°/${data.temp_max}°`);
                        $('#tomorrow-temp').html(`${data.temp_min}°/${data.temp_max}°`);
                    }
                },
                error: function() {
                    console.error("Erro ao obter dados da API.");
                }
            });
        }

        // Faz a requisição a cada 30 segundos
        setInterval(fetchWeatherData, 30000);

        // Faz a primeira chamada quando a página carrega
        $(document).ready(function() {
            fetchWeatherData();
        });
    </script>
</head>
<body class="flex space-between" style="background-image: url({% static 'src/banners/background.png' %});">
    <div class="left-column">
        <div class="left-window">
            <video width="100%" height="100%" controls autoplay src="{% static 'animation/Carregamento.mp4' %}"></video>
        </div>

        <div class="description flex column">
            <div class="textbox flex column">
                <h3>Titulo auxiliar 18pt</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent semper iaculis vulputate. Cras vel enim aliquet, commodo velit eu, commodo diam. Integer placerat eget enim quis faucibus. Cras vel en</p>
            </div>

            <div class="left-footer footer flex center vcenter">
                <div class="footer-left-text flex center vcenter">
                    00/00/2000
                </div>

                <div class="footer-left-text flex center vcenter">
                    <p>00:00</p>
                </div>

                <div class="footer-left-text flex center vcenter">
                    <p>Hoje</p>
                    <img src="{% static 'src/icons/sun-fill.svg' %}" alt="">
                    <p id="today-temp">Carregando...</p> <!-- Aqui vai ser atualizado via JS -->
                </div>
            </div>
        </div>
    </div>

    <div class="divisor flex space-between">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>

    <div class="right-column flex column center">
        <div class="right-window flex center">
            <div class="background flex center vcenter">
                <div class="background-red"></div>
                <div class="background-org"></div>
                <div class="background-ylw"></div>
                <div class="small-window">
                    <h1>Titulo</h1>
                </div>
            </div>
        </div>

        <div class="textbox flex column">
            <h1>Titulo Verdana 24pt</h1>
            <p>is simply dummy text of the printing and typesetting industry. Just ignore it</p>
        </div>

        <img class="fatec-banner" src="{% static 'src/banners/FatecCarapicuiba_Marca_Branca_Cor_SombraLateral.png' %}" alt="">

        <div class="footer flex center vcenter">
            <p>Amanhã</p>
            <img src="{% static 'src/icons/umbrella-simple-fill.svg' %}" alt="">
            <p id="tomorrow-temp">Carregando...</p> <!-- Aqui também vai ser atualizado via JS -->
        </div>
    </div>

    <div class="user-notices flex column center">
        <h2>Usuários</h2>
        <ul>
            {% for user in users %}
                <li>{{ user.full_name }} ({{ user.email }})</li>
            {% empty %}
                <li>Nenhum usuário encontrado.</li>
            {% endfor %}
        </ul>
        
        <h2>Notificações</h2>
        <div>
            {% for notice in notices %}
                <div class="notice-item">
                    <h4>{{ notice.subject }}</h4>
                    <p>{{ notice.content }}</p>
                    <p><strong>Responsável:</strong> {{ notice.responsible }}</p>
                    <p><strong>Data de Início:</strong> {{ notice.start_date }} {{ notice.start_time }}</p>
                    <p><strong>Data de Fim:</strong> {{ notice.end_date }} {{ notice.end_time }}</p>
                </div>
            {% empty %}
                <p>Nenhuma notificação encontrada.</p>
            {% endfor %}
        </div>
    </div>
</body>
</html>
